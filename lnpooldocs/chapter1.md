
# 1.Introduction

#### Lightning Network Bootstrapping Challenges.

The Lightning Network (LN) is the largest deployed Layer 2 payment channel network [1]. A payment channel network is comprised of a series of individual payment channels, which, when strung together, enable rapid low-latency payments between participants in the network. Due to the oﬀ-chain nature of these payments (only the ﬁnal summary hits the blockchain), the cost of payments on the LN are typically much lower than an equivalent payment on the base blockchain. In order to  be able to send funds on a network, a user must open a payment channel to another participant on the network. Once the channel has been opened, both participants are able to send and receive a nearly unbounded number of pay- ments oﬀ-chain, possibly never closing the channel on-chain. Similarly, in order to receive on the network, a user requires another individual to open a channel to the receiver. A participant can only send and receive up to the total amount of Bitcoin in a channel committed to by both parties. This allocation of capital by one party to enable another party to receive funds on the network is typi- cally referred to as inbound liquidity or inbound bandwidth. Because a would-be user of the network must somehow convince others to allocate capital towards them in order to receive funds on the network, the inbound bandwidth problem remains a signiﬁcant barrier to the adoption and bootstrapping of the Lightning Network.

#### Routing Node Capital Requirements.

In order to incentivize users to commit capital to the network so as to help other users of the network send and receive payments, each time a node forwards a payment successfully they receive a fee. As commonly implemented, this fee has a ﬁxed base amount to be paid for all forwards independent of payment size, and a fee rate or proportional amount that must be paid for each millionth of a satoshi forwarded [22]. We refer to nodes that join in order to facilitate payments and collect forwarding fees as routing nodes. In order to forward a payment of size N on the network, a routing node needs to have Nin + F Bitcoin allocated towards it as inbound bandwidth, and Nout Bitcoin allocated to another node as outbound bandwidth. The factor of F is the fee collected by the routing node, with the following constraint being met F = Nin Nout. Due to this requirement that there be suﬃcient inbound  and outbound bandwidth, even those nodes that exist solely to help other nodes send and receive payments, themselves face the inbound bandwidth allocation problem, a fundamental bootstrapping issue for the LN.

#### Market Design Resource Allocation Problems.

The ﬁeld of market design is a sub-ﬁeld of economics which is concerned primarily with the eﬃcient allocation of scarce resources [16] . Within this sub-ﬁeld, of interest is a branch of market design concerned with instances wherein money is used to govern the exchange of goods and services: auction design. Auction design can be used  to eﬀectively allocate scarce resources within a domain. Common established examples of market design widely used today include: carbon emissions credits, electricity markets, auctions for airport gates, and wireless spectrum auctions. In each of these examples, market design is used to allow more eﬀective com- munication of pricing information, resource availability, and the expression of preferences. Our ﬁrst insight is framing the solution to the inbound bandwidth bootstrapping problem within the lens of market design. In the context of the LN, the scarce resource we aim to more eﬃciently allocate is inbound channel bandwidth.

#### LN Bootstrapping as Resource Allocation Problem.

In the absence of a proper venue, those that need inbound capital to operate their Lightning services often turn to soliciting capital on various chat groups, forums, or public venues like Twitter. On the other side, those seeking to deploy capital in order to facilitate network operation and gain routing fees must guess as to exactly where their capital is most demanded. As node operators may not necessarily know where their capital is most demanded, they risk opening channels to lo- cations where they aren’t actually needed, leading to poor resource utilization and capital ineﬃciency. It’s as if node operators are speculatively building roads that no one will use (why isn’t my node forwarding?), and those seeking to re- ceive aren’t able to ﬂag their service as an attractive destination to be connected to internal network ”highways”. Lightning Pool solves this resource allocation problem using an auction that matches up those seeking to deploy capital (by opening channels) to those that need these channels to operate their Lightning Service or business. With each executed batch, the participants of the auction derive a per block interest rate which is eﬀectively the current lease rate for capital on the Lightning Network. The auctioneer or an independent agency is also able to provide Node Ratings to participants of the network, which can be used to make more informed decisions with respect to the quality of the channel lease being purchased.

#### Channel Lease Marketplaces.

In this paper, we present Lightning Pool, a non-custodial channel lease marketplace (CLM) that draws on modern auc- tion theory to construct an auction that enables participants to buy and sell inbound channel bandwidth. Participants in the marketplace buy and sell a channel capital obligation, which we call a Lightning Channel Lease (LCL). An LCL is similar to a traditional bond in that one party acquires capital from another for productive use, with the party parting with their capital being com- pensated for their cost of capital. However as the funds within an LCL can only be used in the Lightning Network for sending/receiving, an LCL is analogous to the creation of a new virtual ”road” within the LN connecting two destinations. Critically, when one purchases an LCL, the period of time those funds must  be committed is enforced on-chain using Bitcoin Script. As a result, buyers of inbound channel bandwidth can be sure the capital will be committed for a set period of time. The auction itself contains several sub-auctions for the exchange of particular duration intervals expressed in blocks (similar to the various U.S Treasury auctions [3]). A non-trusted auctioneer facilities the marketplace by accepting sealed-bid orders, clearing the market using a uniform clearing price for each duration bucket, and ﬁnally executing batches of contracts using exe- cution transactions that update all involved accounts, delivering the purchased channels to all parties in an atomic manner. Lightning Pool and the LCL solve the inbound bandwidth problem by allowing participants on the network to eﬀectively exchange pricing signals to determine exactly where in the network capital should be allocated.

#### Shadowchains as an Application Framework.

Lightning Pool is the ﬁrst application built on top of Bitcoin that utilizes the Shadowchain paradigm to construct an application-speciﬁc overlay system on top of existing Bitcoin unspent transaction outputs (UTXOs). A user joins a shadowchain by creating a special multi-signature based output using a public key provided by the tar- get shadowchain manager. Once a user has joined the shadowchain, proposed state transitions are packaged up (in the form of a block) by the shadowchain manager and proposed to each active participant. A shadowchain block updates the application state of all participants and is embedded within a normal Bit- coin transaction. Depending on the application, a shadowchain block may be indistinguishable from a normal Bitcoin transaction. Shadowchains are able to compress state transitions oﬀ-chain by employing a form of multi-party trans- action cut-through [14]. As participants of a shadowchain remain in custody of their funds at all times, complex fraud proofs or exit games are unnecessary, signiﬁcantly simplifying the implementation of a given shadowchain. We note that the shadowchain concept itself can be used for other applications as well.

## 1.1 Our Contributions

In summary, we make the following contributions:

* We propose a solution to the inbound bandwidth problem of the LN in the form of a marketplace to buy and sell inbound bandwidth obligations.

* We propose the Lightning Channel Lease, an inbound bandwidth obliga- tion contract that pays a per-block interest rate to the seller from the buyer, and whose duration is enforced on-chain with Bitcoin Script.

* We  put forth the concept of a Node Rating agency for channel leases    in order to provide marketplace participants with information about the quality of a channel lease.

* We construct a new system, Lightning Pool, which is a non-custodial marketplace with oﬀ-chain order submission and on-chain batch execution that allows parties to exchange LCLs in an atomic manner.

* We design a new Bitcoin application design framework, the shadowchain, which can also serve other applications.
